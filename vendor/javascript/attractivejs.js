// attractivejs@0.8.0 downloaded from https://ga.jspm.io/npm:attractivejs@0.8.0/dist/attractive.js

var t={};(function(e,s){t=s()})(0,(function(){class Debug{static enabled=false;static prefix="🧲 ";static log(...t){this.enabled&&console.log(this.prefix,...t)}static warn(...t){this.enabled&&console.warn(this.prefix,...t)}static error(...t){this.enabled&&console.error(this.prefix,...t)}static throw(t){throw new Error(`${this.prefix}${t}`)}}class Events{#t;constructor(t){Debug.log("Events with actions:",Object.keys(t));this.#t=t}process(t,{on:e,using:s}){if(!e)return;const r=this.#e(e.dataset.action);r.forEach((r=>this.#s(r,{for:t,on:e,using:s})))}#e(t){const e=[];let s="";let r=false;[...t].forEach((t=>{if(t==="`")return r=!r;if(t===" "&&!r)return s&&(e.push(s),s="");s+=t}));s&&e.push(s);return e}#s(t,{for:e,on:s,using:r}){Debug.log("Process action for",e.type,"on",s,"…");if(t.includes("->")){const[r,a]=t.split("->");if(r!==e.type)return;this.#r(a,{on:s})}else e.type===r&&this.#r(t,{on:s});Debug.log("…","processed action for",e.type,"on",s)}#r(t,{on:e}){Debug.log("Execute action",t,"on",e,"…");const s=t.split("#");const[r,a,i]=s;const o=this.#t[r]?r:a??t;const n=this.#t[r]?s.slice(1).join("#"):i??null;if(typeof this.#t[o]==="function"){this.#t[o](e,{value:n,targetElement:e.dataset.target});Debug.log("…","executed action",t,"on",e)}}}class EventTypes{identify({by:t}){const e=t.split(" ");return e.filter((t=>t.includes("->"))).map((t=>t.split("->")[0]))}getDefault({from:t}){const e=t.tagName.toLowerCase();const s=e==="input";const r=s?t.type||"text":null;return s?this.#a.input[r]||this.#a.input.default:this.#a[e]||this.#a.default}#a={a:"click",button:"click",input:{checkbox:"change",radio:"change",submit:"click",button:"click",reset:"click",default:"input"},select:"change",textarea:"input",form:"submit",default:"click"}}var t=new EventTypes;class Observer{#i;#o;constructor(t){this.#i=t}start(t){if(window.MutationObserver){this.#o=new MutationObserver((e=>{const s=new Set;e.forEach((e=>this.#n(e,{for:t,and:s})));s.forEach((t=>this.#i(t)))}));this.#o.observe(document.documentElement,{childList:true,subtree:true});return this}}stop(){this.#o&&this.#o.disconnect();return this}#n(t,{for:e,and:s}){t.type==="childList"&&t.addedNodes.forEach((t=>{this.#c(t,{for:e,and:s})}))}#c(t,{for:e,and:s}){if(t.nodeType===Node.ELEMENT_NODE){t.matches&&t.matches(e)&&s.add(t);t.querySelectorAll&&t.querySelectorAll(e).forEach((t=>s.add(t)))}}}class ActionBase{constructor(t,e={}){if(!t)throw new Error("Current element is required");this.currentElement=t;this.targetElement=e.targetElement;this.options=e}get targets(){return this.targetElement?Array.from(document.querySelectorAll(this.targetElement)):[this.currentElement]}cycledValue(t,e){const s=Array.isArray(e)?e:e.split(",").map((t=>t.trim()));const r=s.indexOf(t);const a=(r+1)%s.length;return s[a]}}class Attribute extends ActionBase{constructor(t,e={}){super(t,e);const[s,r]=e.value.split("=");this.attribute=s;this.value=r}toggle(){this.attribute&&this.targets.forEach((t=>t.hasAttribute(this.attribute)?t.removeAttribute(this.attribute):t.setAttribute(this.attribute,this.value||"")))}cycle(){this.value&&this.targets.forEach((t=>this.#l(t)))}add(){this.attribute&&this.targets.forEach((t=>t.setAttribute(this.attribute,this.value||"")))}remove(){this.attribute&&this.targets.forEach((t=>t.removeAttribute(this.attribute)))}#l(t){const e=this.cycledValue(t.getAttribute(this.attribute),this.value);t.setAttribute(this.attribute,e)}}const e=t=>(e,s={})=>{const r=new Attribute(e,s);return r[t]()};var s={toggleAttribute:e("toggle"),cycleAttribute:e("cycle"),addAttribute:e("add"),removeAttribute:e("remove")};const r=t=>t?.split(",").map((t=>t.trim())).filter(Boolean)??[];class Class extends ActionBase{constructor(t,e={}){super(t,e);this.value=r(e.value)}toggle(){this.value&&this.targets.forEach((t=>this.#u({forEach:t})))}cycle(){this.value&&this.value.length!==0&&this.targets.forEach((t=>this.#h(t)))}add(){this.value&&this.targets.forEach((t=>t.classList.add(...this.value)))}remove(){this.value&&this.targets.forEach((t=>t.classList.remove(...this.value)))}#u({forEach:t}){this.value.forEach((e=>t.classList.toggle(e)))}#h(t){const e=this.value.find((e=>t.classList.contains(e)))||"";const s=this.cycledValue(e,this.value);t.classList.remove(...this.value);t.classList.add(s)}}const a=t=>(e,s={})=>{const r=new Class(e,s);return r[t]()};var i={toggleClass:a("toggle"),cycleClass:a("cycle"),addClass:a("add"),removeClass:a("remove")};let o;const n=(t,e)=>{clearTimeout(o);o=setTimeout(t,e)};class Clipboard extends ActionBase{constructor(t,e={}){super(t,e);this.value=e.value;const s=t.dataset.copyDuration;this.duration=s?parseInt(s):2e3}async copy(){const t=this.value||(this.targets[0]?.value??this.targets[0]?.textContent);if(t!==void 0)try{await navigator.clipboard.writeText(t);this.#d(true)}catch(t){this.#d(false)}}#d(t){const e=String(t);this.targets.forEach((t=>t.setAttribute(this.#g,e)));n((()=>{this.targets.forEach((t=>t.removeAttribute(this.#g)))}),this.duration)}get#g(){return"data-copy-success"}}const c=t=>(e,s={})=>{const r=new Clipboard(e,s);return r[t]()};var l={copy:c("copy")};class DataAttribute extends ActionBase{constructor(t,e={}){super(t,e);const[s,r]=e.value.split("=");this.attribute=s;this.value=r}toggle(){this.attribute&&this.targets.forEach((t=>this.attribute in t.dataset?delete t.dataset[this.attribute]:t.dataset[this.attribute]=this.value||""))}cycle(){this.value&&this.targets.forEach((t=>this.#b(t)))}add(){this.attribute&&this.targets.forEach((t=>t.dataset[this.attribute]=this.value||""))}remove(){this.attribute&&this.targets.forEach((t=>delete t.dataset[this.attribute]))}#b(t){const e=this.cycledValue(t.dataset[this.attribute],this.value);t.dataset[this.attribute]=e}}const u=t=>(e,s={})=>{const r=new DataAttribute(e,s);return r[t]()};var h={toggleDataAttribute:u("toggle"),cycleDataAttribute:u("cycle"),addDataAttribute:u("add"),removeDataAttribute:u("remove")};class Dialog extends ActionBase{open(){this.#f.forEach((t=>t instanceof HTMLDialogElement&&t.show()))}openModal(){this.#f.forEach((t=>t instanceof HTMLDialogElement&&t.showModal()))}close(){this.#f.forEach((t=>t instanceof HTMLDialogElement&&t.close()))}get#f(){return this.targetElement?Array.from(document.querySelectorAll(this.targetElement)):Array.from(document.querySelectorAll("dialog"))}}const d=t=>(e,s={})=>{new Dialog(e,s)[t]()};var g={open:d("open"),openModal:d("openModal"),close:d("close")};class Form extends ActionBase{requestSubmit(){const t=()=>this.targets.forEach((t=>t instanceof HTMLFormElement&&t.requestSubmit()));const e=parseInt(this.currentElement.dataset.submitDelay)||0;e>0?n(t,e):t()}reset(){this.targets.forEach((t=>t instanceof HTMLFormElement&&t.reset()))}}const b=t=>(e,s={})=>{new Form(e,s)[t]()};var f={submit:b("requestSubmit"),reset:b("reset")};class Intersection extends ActionBase{constructor(t,e={}){super(t,e);this.classNames=r(e.value);this.justOnce=e.actionName==="intersect-once"}start(){if(this.classNames.length===0)return;const t=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting?this.#v(t,e.target):this.#m()}))}));t.observe(this.currentElement)}#v(t,e){this.targets.forEach((t=>t.classList.add(...this.classNames)));this.justOnce&&t.unobserve(e)}#m(){this.justOnce||this.targets.forEach((t=>t.classList.remove(...this.classNames)))}}const v=t=>(e,s={})=>{const r=new Intersection(e,{...s,actionName:t});return r.start()};var m={"intersect-once":v("intersect-once"),"intersect-toggle":v("intersect-toggle")};class Reload extends ActionBase{reload(){this.targets.forEach((t=>{this.#p(t)?t.reload():window.location.reload()}))}#p(t){return t instanceof FrameElement}}const p=t=>(e,s={})=>{const r=new Reload(e,s);return r[t]()};var E={reload:p("reload"),refresh:p("reload")};class ScrollTo extends ActionBase{constructor(t,e={}){super(t,e);const s=["auto","instant","smooth"];const r=e.value;this.behavior=s.includes(r)?r:"auto"}scroll(){this.targets[0]?.scrollIntoView({behavior:this.behavior})}}const A=t=>(e,s={})=>{const r=new ScrollTo(e,s);return r[t]()};var y={scrollTo:A("scroll")};const w={attribute:s,class:i,clipboard:l,dataAttribute:h,dialog:g,form:f,intersection:m,reload:E,scrollTo:y};const D=(t=[])=>t.length===0?Object.values(w).reduce(((t,e)=>({...t,...e})),{}):w.reduce(((e,s)=>{if(!t[s]){console.warn(`Action “${s}” not found`);return e}return{...e,...t[s]}}),{});var L=D([]);class Attractive{#E={};#A;#y;#w=["scrollTo","intersect-once","intersect-toggle"];static get debug(){return Debug.enabled}static set debug(t){Debug.enabled=t}constructor(){this.#A=new Events(L);this.#y=new Observer((t=>this.#D(t)))}activate(t={}){const{on:e=document,debug:s=false}=t;Debug.enabled=s;Debug.log("Initializing…");this.element=e;this.#y.start("[data-action]");this.element.querySelectorAll("[data-action]").forEach((t=>this.#D(t)));Debug.log("…initialized");return this}withActions(t=[]){Debug.log("Initializing with actions",t);this.#A=new Events(D(t));return this}#D(e){const s=e.dataset.action;if(!s)return;const r=s.split(" ");const a=r.filter((t=>this.#w.includes(t.split("#")[0])));if(a.length>0){a.forEach((t=>this.#L({action:t,on:e})));return}const i=new Set(s.includes("->")?t.identify({by:s}):[t.getDefault({from:e})]);i.forEach((t=>this.#x({for:t})))}#x({for:t}){if(!this.#E[t]){this.element.addEventListener(t,(t=>this.#T(t)));Debug.log("Added event listener for",t,"to",this.element);this.#E[t]=true}}#T(e){const s=e.target.closest("[data-action]");if(!s)return;const r=t.getDefault({from:s});this.#A.process(e,{on:s,using:r})}#L({action:t,on:e}){const[s,...r]=t.split("#");if(typeof L[s]!=="function")return;const a=r.length>0?r.join("#"):null;const i=e.dataset.target;L[s](e,{value:a,targetElement:i})}}var x=new Attractive;const T=(t=document)=>{window.Attractive&&window.Attractive._initialized||x.activate({element:t})};if(typeof document!=="undefined"){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",(()=>T())):T();document.addEventListener("turbo:load",(()=>T()))}typeof window!=="undefined"&&(window.Attractive=x);return x}));var e=t;export{e as default};

