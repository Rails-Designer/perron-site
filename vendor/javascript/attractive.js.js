// attractive.js@0.5.0 downloaded from https://ga.jspm.io/npm:attractive.js@0.5.0/dist/attractive.js

var t={};(function(e,s){t=s()})(0,(function(){class Debug{static enabled=false;static prefix="🧲 ";static log(...t){this.enabled&&console.log(this.prefix,...t)}static warn(...t){this.enabled&&console.warn(this.prefix,...t)}static error(...t){this.enabled&&console.error(this.prefix,...t)}static throw(t){throw new Error(`${this.prefix}${t}`)}}class Events{#t;constructor(t){Debug.log("Events with actions:",Object.keys(t));this.#t=t}process(t,{on:e,using:s}){if(!e)return;const r=e.dataset.action;const a=r.split(" ");a.forEach((r=>this.#e(r,{for:t,on:e,using:s})))}#e(t,{for:e,on:s,using:r}){Debug.log("Process action for",e.type,"on",s,"…");if(t.includes("->")){const[r,a]=t.split("->");if(r!==e.type)return;this.#s(a,{on:s})}else e.type===r&&this.#s(t,{on:s});Debug.log("…","processed action for",e.type,"on",s)}#s(t,{on:e}){Debug.log("Execute action",t,"on",e,"…");const s=t.split("#");const[r,a,i]=s;const o=this.#t[r]?r:a??t;const n=this.#t[r]?s.slice(1).join("#"):i??null;if(typeof this.#t[o]==="function"){this.#t[o](e,{value:n,targetElement:e.dataset.target});Debug.log("…","executed action",t,"on",e)}}}class EventTypes{identify({by:t}){const e=t.split(" ");return e.filter((t=>t.includes("->"))).map((t=>t.split("->")[0]))}getDefault({from:t}){const e=t.tagName.toLowerCase();const s=e==="input";const r=s?t.type||"text":null;return s?this.#r.input[r]||this.#r.input.default:this.#r[e]||this.#r.default}#r={a:"click",button:"click",input:{checkbox:"change",radio:"change",submit:"click",button:"click",reset:"click",default:"input"},select:"change",textarea:"input",form:"submit",default:"click"}}var t=new EventTypes;class Observer{#a;#i;constructor(t){this.#a=t}start(t){if(window.MutationObserver){this.#i=new MutationObserver((e=>{const s=new Set;e.forEach((e=>this.#o(e,{for:t,and:s})));s.forEach((t=>this.#a(t)))}));this.#i.observe(document.documentElement,{childList:true,subtree:true});return this}}stop(){this.#i&&this.#i.disconnect();return this}#o(t,{for:e,and:s}){t.type==="childList"&&t.addedNodes.forEach((t=>{this.#n(t,{for:e,and:s})}))}#n(t,{for:e,and:s}){if(t.nodeType===Node.ELEMENT_NODE){t.matches&&t.matches(e)&&s.add(t);t.querySelectorAll&&t.querySelectorAll(e).forEach((t=>s.add(t)))}}}class ActionBase{constructor(t,e={}){if(!t)throw new Error("Current element is required");this.currentElement=t;this.targetElement=e.targetElement;this.options=e}get targets(){return this.targetElement?Array.from(document.querySelectorAll(this.targetElement)):[this.currentElement]}}class Attribute extends ActionBase{constructor(t,e={}){super(t,e);const[s,r]=e.value.split("=");this.attribute=s;this.value=r}toggle(){this.attribute&&this.targets.forEach((t=>t.hasAttribute(this.attribute)?t.removeAttribute(this.attribute):t.setAttribute(this.attribute,this.value||"")))}add(){this.attribute&&this.targets.forEach((t=>t.setAttribute(this.attribute,this.value||"")))}remove(){this.attribute&&this.targets.forEach((t=>t.removeAttribute(this.attribute)))}}const e=t=>(e,s={})=>{const r=new Attribute(e,s);return r[t]()};var s={toggleAttribute:e("toggle"),addAttribute:e("add"),removeAttribute:e("remove")};const r=t=>t?.split(",").map((t=>t.trim())).filter(Boolean)??[];class Class extends ActionBase{constructor(t,e={}){super(t,e);this.value=r(e.value)}toggle(){this.value&&this.targets.forEach((t=>this.#c({forEach:t})))}add(){this.value&&this.targets.forEach((t=>t.classList.add(...this.value)))}remove(){this.value&&this.targets.forEach((t=>t.classList.remove(...this.value)))}#c({forEach:t}){this.value.forEach((e=>t.classList.toggle(e)))}}const a=t=>(e,s={})=>{const r=new Class(e,s);return r[t]()};var i={toggleClass:a("toggle"),addClass:a("add"),removeClass:a("remove")};let o;const n=(t,e)=>{clearTimeout(o);o=setTimeout(t,e)};class Clipboard extends ActionBase{constructor(t,e={}){super(t,e);this.value=e.value;const s=t.dataset.copyDuration;this.duration=s?parseInt(s):2e3}async copy(){const t=this.value||(this.targets[0]?.value??this.targets[0]?.textContent);if(t!==void 0)try{await navigator.clipboard.writeText(t);this.#l(true)}catch(t){this.#l(false)}}#l(t){const e=String(t);this.targets.forEach((t=>t.setAttribute(this.#u,e)));n((()=>{this.targets.forEach((t=>t.removeAttribute(this.#u)))}),this.duration)}get#u(){return"data-copy-success"}}const c=t=>(e,s={})=>{const r=new Clipboard(e,s);return r[t]()};var l={copy:c("copy")};class DataAttribute extends ActionBase{constructor(t,e={}){super(t,e);const[s,r]=e.value.split("=");this.attribute=s;this.value=r}toggle(){this.attribute&&this.targets.forEach((t=>this.attribute in t.dataset?delete t.dataset[this.attribute]:t.dataset[this.attribute]=this.value||""))}add(){this.attribute&&this.targets.forEach((t=>t.dataset[this.attribute]=this.value||""))}remove(){this.attribute&&this.targets.forEach((t=>delete t.dataset[this.attribute]))}}const u=t=>(e,s={})=>{const r=new DataAttribute(e,s);return r[t]()};var h={toggleDataAttribute:u("toggle"),addDataAttribute:u("add"),removeDataAttribute:u("remove")};class Dialog extends ActionBase{open(){this.#h.forEach((t=>t instanceof HTMLDialogElement&&t.show()))}openModal(){this.#h.forEach((t=>t instanceof HTMLDialogElement&&t.showModal()))}close(){this.#h.forEach((t=>t instanceof HTMLDialogElement&&t.close()))}get#h(){return this.targetElement?Array.from(document.querySelectorAll(this.targetElement)):Array.from(document.querySelectorAll("dialog"))}}const d=t=>(e,s={})=>{new Dialog(e,s)[t]()};var g={open:d("open"),openModal:d("openModal"),close:d("close")};class Form extends ActionBase{requestSubmit(){const t=()=>this.targets.forEach((t=>t instanceof HTMLFormElement&&t.requestSubmit()));const e=parseInt(this.currentElement.dataset.submitDelay)||0;e>0?n(t,e):t()}reset(){this.targets.forEach((t=>t instanceof HTMLFormElement&&t.reset()))}}const b=t=>(e,s={})=>{new Form(e,s)[t]()};var v={submit:b("requestSubmit"),reset:b("reset")};class Intersection extends ActionBase{constructor(t,e={}){super(t,e);this.classNames=r(e.value);this.justOnce=e.actionName==="intersect-once"}start(){if(this.classNames.length===0)return;const t=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting?this.#d(t,e.target):this.#g()}))}));t.observe(this.currentElement)}#d(t,e){this.targets.forEach((t=>t.classList.add(...this.classNames)));this.justOnce&&t.unobserve(e)}#g(){this.justOnce||this.targets.forEach((t=>t.classList.remove(...this.classNames)))}}const f=t=>(e,s={})=>{const r=new Intersection(e,{...s,actionName:t});return r.start()};var m={"intersect-once":f("intersect-once"),"intersect-toggle":f("intersect-toggle")};class ScrollTo extends ActionBase{constructor(t,e={}){super(t,e);const s=["auto","instant","smooth"];const r=e.value;this.behavior=s.includes(r)?r:"auto"}scroll(){this.targets[0]?.scrollIntoView({behavior:this.behavior})}}const p=t=>(e,s={})=>{const r=new ScrollTo(e,s);return r[t]()};var E={scrollTo:p("scroll")};const w={attribute:s,class:i,clipboard:l,dataAttribute:h,dialog:g,form:v,intersection:m,scrollTo:E};const A=(t=[])=>t.length===0?Object.values(w).reduce(((t,e)=>({...t,...e})),{}):w.reduce(((e,s)=>{if(!t[s]){console.warn(`Action “${s}” not found`);return e}return{...e,...t[s]}}),{});var y=A([]);class Attractive{#b={};#v;#f;#m=["scrollTo","intersect-once","intersect-toggle"];static get debug(){return Debug.enabled}static set debug(t){Debug.enabled=t}constructor(){this.#v=new Events(y);this.#f=new Observer((t=>this.#p(t)))}activate(t={}){const{on:e=document,debug:s=false}=t;Debug.enabled=s;Debug.log("Initializing…");this.element=e;this.#f.start("[data-action]");this.element.querySelectorAll("[data-action]").forEach((t=>this.#p(t)));Debug.log("…initialized");return this}withActions(t=[]){Debug.log("Initializing with actions",t);this.#v=new Events(A(t));return this}#p(e){const s=e.dataset.action;if(!s)return;const r=s.split(" ");const a=r.filter((t=>this.#m.includes(t.split("#")[0])));if(a.length>0){a.forEach((t=>this.#E({action:t,on:e})));return}const i=new Set(s.includes("->")?t.identify({by:s}):[t.getDefault({from:e})]);i.forEach((t=>this.#w({for:t})))}#w({for:t}){if(!this.#b[t]){this.element.addEventListener(t,(t=>this.#A(t)));Debug.log("Added event listener for",t,"to",this.element);this.#b[t]=true}}#A(e){const s=e.target.closest("[data-action]");if(!s)return;const r=t.getDefault({from:s});this.#v.process(e,{on:s,using:r})}#E({action:t,on:e}){const[s,...r]=t.split("#");if(typeof y[s]!=="function")return;const a=r.length>0?r.join("#"):null;const i=e.dataset.target;y[s](e,{value:a,targetElement:i})}}var D=new Attractive;const L=(t=document)=>{window.Attractive&&window.Attractive._initialized||D.activate({element:t})};if(typeof document!=="undefined"){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",(()=>L())):L();document.addEventListener("turbo:load",(()=>L()))}typeof window!=="undefined"&&(window.Attractive=D);return D}));var e=t;export{e as default};

