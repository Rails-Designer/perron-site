// attractive.js@0.2.0 downloaded from https://ga.jspm.io/npm:attractive.js@0.2.0/dist/attractive.js

var t={};(function(e,s){t=s()})(0,(function(){class Debug{static enabled=false;static prefix="[ðŸ§²]";static log(...t){this.enabled&&console.log(this.prefix,...t)}static warn(...t){this.enabled&&console.warn(this.prefix,...t)}static error(...t){this.enabled&&console.error(this.prefix,...t)}static throw(t){throw new Error(`${this.prefix}${t}`)}}class Events{#t;constructor(t){Debug.log("Events with actions:",Object.keys(t));this.#t=t}process(t,{on:e,using:s}){if(!e)return;const i=e.dataset.action;const r=i.split(" ");r.forEach((i=>this.#e(i,{for:t,on:e,using:s})))}#e(t,{for:e,on:s,using:i}){Debug.log("Process action for",e.type,"on",s,"â€¦");if(t.includes("->")){const[i,r]=t.split("->");if(i!==e.type)return;this.#s(r,{on:s})}else e.type===i&&this.#s(t,{on:s});Debug.log("â€¦","processed action for",e.type,"on",s)}#s(t,{on:e}){Debug.log("Execute action",t,"on",e,"â€¦");const[s,i=null]=t.includes("#")?t.split("#"):[t];if(!this.#t[s]||typeof this.#t[s]!=="function")return;const r=e.dataset.target;this.#t[s](e,{value:i,targetElement:r});Debug.log("â€¦","executed action",t,"on",e)}}class EventTypes{identify({by:t}){const e=t.split(" ");return e.filter((t=>t.includes("->"))).map((t=>t.split("->")[0]))}getDefault({from:t}){const e=t.tagName.toLowerCase();const s=e==="input";const i=s?t.type||"text":null;return s?this.#i.input[i]||this.#i.input.default:this.#i[e]||this.#i.default}#i={a:"click",button:"click",input:{checkbox:"change",radio:"change",submit:"click",button:"click",reset:"click",default:"input"},select:"change",textarea:"input",form:"submit",default:"click"}}var t=new EventTypes;class Observer{#r;#a;constructor(t){this.#r=t}start(t){if(window.MutationObserver){this.#a=new MutationObserver((e=>{const s=new Set;e.forEach((e=>this.#n(e,{for:t,and:s})));s.forEach((t=>this.#r(t)))}));this.#a.observe(document.documentElement,{childList:true,subtree:true});return this}}stop(){this.#a&&this.#a.disconnect();return this}#n(t,{for:e,and:s}){t.type==="childList"&&t.addedNodes.forEach((t=>{this.#o(t,{for:e,and:s})}))}#o(t,{for:e,and:s}){if(t.nodeType===Node.ELEMENT_NODE){t.matches&&t.matches(e)&&s.add(t);t.querySelectorAll&&t.querySelectorAll(e).forEach((t=>s.add(t)))}}}class ActionBase{constructor(t,e={}){if(!t)throw new Error("Current element is required");this.currentElement=t;this.targetElement=e.targetElement;this.options=e}get targets(){return this.targetElement?Array.from(document.querySelectorAll(this.targetElement)):[this.currentElement.parentElement]}}class Class extends ActionBase{constructor(t,e={}){super(t,e);this.value=this.sanitize(e.value)}toggle(){this.value&&this.targets.forEach((t=>this.#c({forEach:t})))}add(){this.value&&this.targets.forEach((t=>t.classList.add(...this.value)))}remove(){this.value&&this.targets.forEach((t=>t.classList.remove(...this.value)))}sanitize(t){return t?.split(",").map((t=>t.trim())).filter(Boolean)}#c({forEach:t}){this.value.forEach((e=>t.classList.toggle(e)))}}const e=t=>(e,s={})=>{const i=new Class(e,s);return i[t]()};var s={toggleClass:e("toggle"),addClass:e("add"),removeClass:e("remove")};class Attribute extends ActionBase{constructor(t,e={}){super(t,e);const[s,i]=e.value.split("=");this.attribute=s;this.value=i}toggle(){this.attribute&&this.targets.forEach((t=>t.hasAttribute(this.attribute)?t.removeAttribute(this.attribute):t.setAttribute(this.attribute,this.value||"")))}add(){this.attribute&&this.targets.forEach((t=>t.setAttribute(this.attribute,this.value||"")))}remove(){this.attribute&&this.targets.forEach((t=>t.removeAttribute(this.attribute)))}}const i=t=>(e,s={})=>{const i=new Attribute(e,s);return i[t]()};var r={toggleAttribute:i("toggle"),addAttribute:i("add"),removeAttribute:i("remove")};class DataAttribute extends ActionBase{constructor(t,e={}){super(t,e);const[s,i]=e.value.split("=");this.attribute=s;this.value=i}toggle(){this.attribute&&this.targets.forEach((t=>this.attribute in t.dataset?delete t.dataset[this.attribute]:t.dataset[this.attribute]=this.value||""))}add(){this.attribute&&this.targets.forEach((t=>t.dataset[this.attribute]=this.value||""))}remove(){this.attribute&&this.targets.forEach((t=>delete t.dataset[this.attribute]))}}const a=t=>(e,s={})=>{const i=new DataAttribute(e,s);return i[t]()};var n={toggleDataAttribute:a("toggle"),addDataAttribute:a("add"),removeDataAttribute:a("remove")};const o={class:s,attribute:r,DataAttribute:n};const c=(t=[])=>t.length===0?Object.values(o).reduce(((t,e)=>({...t,...e})),{}):o.reduce(((e,s)=>{if(!t[s]){console.warn(`Action â€œ${s}â€ not found`);return e}return{...e,...t[s]}}),{});var u=c([]);class Attractive{#u={};#l;#h;constructor(){Debug.log("Initializingâ€¦");this.#l=new Events(u);this.#h=new Observer((t=>this.#d(t)))}activate(t={}){const{element:e=document}=t;this.element=e;this.#h.start("[data-action]");this.element.querySelectorAll("[data-action]").forEach((t=>this.#d(t)));Debug.log("â€¦initialized");return this}withActions(t=[]){Debug.log("Initializing with actions",t);this.#l=new Events(c(t));return this}#d(e){const s=e.dataset.action;if(!s)return;const i=new Set(s.includes("->")?t.identify({by:s}):[t.getDefault({from:e})]);i.forEach((t=>this.#v({for:t})))}#v({for:t}){if(!this.#u[t]){this.element.addEventListener(t,(t=>this.#f(t)));Debug.log("Added event listener for",t,"to",this.element);this.#u[t]=true}}#f(e){const s=e.target.closest("[data-action]");if(!s)return;const i=t.getDefault({from:s});this.#l.process(e,{on:s,using:i})}}var l=new Attractive;const h=(t=document)=>{window.Attractive&&window.Attractive._initialized||l.activate({element:t})};if(typeof document!=="undefined"){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",(()=>h())):h();document.addEventListener("turbo:load",(()=>h()))}typeof window!=="undefined"&&(window.Attractive=l);return l}));var e=t;export{e as default};

