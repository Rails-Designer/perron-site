gem "perron" unless File.read("Gemfile").include?("perron")
gem "tailwindcss-rails" unless File.read("Gemfile").include?("tailwindcss-rails")

after_bundle do
  unless File.exist?("config/initializers/perron.rb")
    rails_command "generate perron:install"
  end

  rails_command "tailwindcss:install"
  rails_command "generate content page show"
  rails_command "generate content post"

  inject_into_file "app/views/layouts/application.html.erb",
    indent("<%%= feeds only: %w[posts] %>\n", 4),
    before: "</head>"

<% template_files.each do |path, file| %>
file "<%= path %>", force: true do
<<~"_"
<%= File.read(file) %>
_
end
<% end %>
end
